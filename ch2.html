<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>ch2.utf8.md</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Welcome</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ch1.html">1. Mixed Models – why?</a>
    </li>
    <li>
      <a href="ch2.html">2. Tidying data</a>
    </li>
    <li>
      <a href="ch3.html">3. The Basic Two-Level Model</a>
    </li>
    <li>
      <a href="ch4.html">4. The Random Intercept Random Slope Model</a>
    </li>
    <li>
      <a href="ch5.html">5. Interaction Effects and Centering</a>
    </li>
    <li>
      <a href="ch6.html">6. Three Level Models</a>
    </li>
    <li>
      <a href="ch7.html">7. Longitudinal Data / Repeated Measures</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="tidying-data" class="section level1">
<h1>2. Tidying data</h1>
<p>You might be one of those humans that have access to nice, clean and organized data, ready to start your data analysis. If you are, you are missing out on the pleasures of tidying data and you can skip this section. If you are not, you either: (a) belong to the sister/brotherhood of those who delight in torturing data, or (b) you are at the bottom of the academic food chain and you don’t have anyone to do the scut work for you. Either way, mixed models require data to be organized in a specific format and the SPSS commands below might be of use to you. This is not an extensive list, but my own experienced-based choices of what might came in handy most often.</p>
<p>We will be using some Portugese 2011 census data I’ve downloaded from: <a href="http://lisboaaberta.cm-lisboa.pt/index.php/pt/dados/catalogo-de-dados-abertos" class="uri">http://lisboaaberta.cm-lisboa.pt/index.php/pt/dados/catalogo-de-dados-abertos</a>. I’ve edited the data files a bit to fit my purposes (but the data is not fake if that’s what you’re wondering – just some cuts and name changes here and there).</p>
<p>You can download the datasets we’ll use from here: <a href="data/ch2/lx_2011_edu.sav">lx_2011_edu.sav</a> and here: <a href="data/ch2/lx_2011_house.sav">lx_2011_house.sav</a>.</p>
<p>The <strong>lx_2011_edu.sav</strong> dataset includes the following variables:<br />
1. <em>section_id</em> - freguesia’s section identifier code (how do you translate freguesia to English?!? – parish?!?)<br />
2. <em>freg_id</em> - parish identifier code<br />
3. <em>no_education</em> - number of Lisbon illiterate residents per section<br />
4. <em>sup_education</em> - number of Lisbon residents with higher education per section</p>
<p>The <strong>lx_2011_housing.sav</strong> dataset includes the following variables:<br />
1. <em>freg_id</em> - parish identifier code<br />
2. <em>freg</em> – parish name<br />
3. <em>empty_houses</em> – total number of empty houses in each parish<br />
   </p>
<div id="data-merge-files-add-variables" class="section level2">
<h2>2.1. Data &gt; Merge Files &gt; Add Variables</h2>
<p>If you are interested in mixed models you’ll probably know that data can have a nested structure (e.g., sections within parishes, students within schools, repeated observation within subjects) and that some variables refer to lower level units (sections) and other variables to higher level units (parishes).<br />
If you don’t know this already you’ll know it before the day is over. In practical terms, this means that your data files will have a lot of repetitive values within the same higher level units – typing repetitive data by hand is a bit boring (unless you want to practice your mindfulness skills).</p>
<p>For example, imagine that you have a data file with 200 rows, each row containing data for one student, and that these students belong to 20 different schools (10 children per school). Imagine that one of the variables you collected was the total number of students in each school. You can type 20 times the same number for every school, or you can create a dataset with variables referring exclusively to higher level units. This dataset would only have 20 rows. The only thing you need is to have a <strong>“key”</strong> variable (you’ll need more in some cases) to merge the lower level and higher level datasets. This key variable is usually an identifier variable (e.g., school id) that HAS to exist in both datasets.<br />
If you have large datasets, merging can save you a lot a time. Also, you might need to present higher level descriptive statistics and a dataset with just one row for each higher level group might come in handy.</p>
<p>For the above mentioned datasets (<strong>lx_2011_edu.sav</strong> and <strong>lx_2011_housing.sav</strong>) the key variable is <em>freg_id</em>. What we want is to add parish housing data (higher level data) to section’s education data. Just imagine you had to type parish names for every one of the 1044 rows in <strong>lx_2011_edu.sav</strong> dataset (exciting!). Like this you just have to type 53 different names.</p>
<p>Check <strong>figure 2.1.1</strong> to see the necessary steps. In the end you should get something similar to <strong>figure 2.1.2</strong>. You’ll need to have the <strong>lx_2011_edu.sav</strong> file opened (in front of you) because you will need to execute your commands from here (in SPSS language, <strong>lx_2011_edu.sav</strong> should be the active dataset). The instructions in <strong>figure 2.1.1</strong> assume that the <strong>lx_2011_housing.sav</strong> dataset is opened as well (this is not mandatory as you’ll see from the options in the dialog box).</p>
<p><img src="images/ch2/fig2_1_1_merge.gif" /></p>
<p><strong>Figure 2.1.1</strong>. <em>Merging data</em>.<br />
   </p>
<p><img src="images/ch2/fig2_1_2_merged.png" /></p>
<p><strong>Figure 2.1.2</strong>. <em>Merged data</em>.<br />
 </p>
<p>Just a note, in some SPSS versions you will need to sort the key variable in both datasets first (use <strong>Data &gt; Sort Cases</strong> command). In more recent versions there is a checkbox for this task (checked by default) in the <strong>Merge Data &gt; Add Variables dialog box</strong>, so if you’re lucky you don’t need to worry about this.    </p>
</div>
<div id="data-aggregate" class="section level2">
<h2>2.2. Data &gt; Aggregate</h2>
<p>To jump right into it, if you’re going to mix model a lot, you’ll have to do a lot of mean centering (i.e., subtracting mean values). What this implies, is that you’ll (a) have to compute means across groups first (i.e., aggregate data) and then (b) subtract this value from a lower level score.</p>
<p>Imagine for example, that you for some mysterious (but nevertheless valid) reason want to center your height on the mean height of your lab colleagues. For me, a 183cm human being, this would put my centered height at 183 – 170 = 13 (no I didn’t measure anyone in my lab, but 170cm seemed a really nice non-offensive mean height). Mean centered scores just tell you how many units a specific scores is above, or below some mean (usually a group mean or the mean of the entire sample). Maybe not the brightest example, but for now just retain that mean centering it’s a thing, and it’s a good thing. We’ll get back to this later.</p>
<p>We will use the dataset from the previous example and add two new variables: <em>no_education_fm</em> (fm for freguesia mean) and sup_education_fm. These variables represent mean parish scores. The following instructions show you how to do this (<strong>figure 2.2.1</strong>), and you should get something like <strong>figure 2.2.2</strong>.</p>
<p><img src="images/ch2/fig2_2_1_agg.gif" /></p>
<p><strong>Figure 2.2.1</strong>. <em>Aggregating data</em>.<br />
   </p>
<p><img src="images/ch2/fig2_2_2_agg.png" /></p>
<p><strong>Figure 2.2.2</strong>. <em>Aggregated data</em>.    </p>
<p>Now you can use these new variables to mean center no_education and sup_education on parish mean scores (this is called <strong>group-mean centering</strong>). Just use the <strong>Transform &gt; Compute Variable</strong> command. We will call these new variables <em>no_education_fm_c</em> (c for centered) and <em>sup_education_fm_c</em>. Instructions provided in <strong>figure 2.2.3</strong> show you how to mean center <em>no_education</em> variable (and get <em>no_education_fm_c</em>). Follow similar steps to mean center <em>sup_education</em>. In the end you should get something like the dataset in <strong>figure 2.2.4</strong>.</p>
<p><img src="images/ch2/fig2_2_3_mc.gif" /></p>
<p><strong>Figure 2.2.3</strong>. <em>Mean centering data</em>.    </p>
<p><img src="images/ch2/fig2_2_4_mc.png" /></p>
<p><strong>Figure 2.2.4</strong>. <em>Mean centered data</em>.    </p>
</div>
<div id="data-restructure" class="section level2">
<h2>2.3. Data &gt; Restructure</h2>
<p>As you probably noticed, both <em>no_education</em> and <em>sup_education</em> refer to counts of Lisbon residents. You can think of these two variables as repeated measures of the same variable (<em>n_residents</em> - number of residents).</p>
<p>As it is, the dataset is organized in what is called the <strong>wide format</strong> – each parish section data is presented in 1 row, with 2 columns for counts of residents belonging to 2 different categories (<em>no_education</em> and <em>sup_education</em>). You need data in this format if you want to do a repeated measures ANOVA, or to correlate no_education and sup_education. Usually this is the way you, or someone else for you, created the data file (it is faster to do it this way – less repetition). But for mixed models you need something different.</p>
<p>To run mixed models on test scores in SPSS (and R, and many other statistical programs) data needs to be in the so called <strong>long format</strong> (<strong>figure 2.3.1</strong>) - some people refer to this as the tidy format. The dataset has too many columns by now to present a proper figure, but at least you can see that we now have duplicate <em>section_id</em> rows: 2 rows for every parish section (long format) instead of 1 row per section (wide format). <strong>Figure 2.3.2</strong> shows you how to convert your data from wide to long. If everything goes well you should get the number of residents (<em>n_residents</em>) in just one column (at the end of the dataset), and another column indexing the education level (<em>education</em>).</p>
<p><img src="images/ch2/fig2_3_1_restructure.png" /></p>
<p><strong>Figure 2.3.1</strong>. <em>Data in long format</em>.    </p>
<p><img src="images/ch2/fig2_3_2_restructure.gif" /></p>
<p><strong>Figure 2.3.2</strong>. <em>Restructuring data</em>.    </p>
<p>This pretty much covers some of the basics of tidying your data in SPSS. You’ll probably use other generic <strong>Data</strong> and <strong>Transform</strong> commands as well, but those are probably more familiar to you.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
